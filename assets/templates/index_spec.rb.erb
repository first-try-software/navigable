require_relative '../../../domain/<%= @resource_name %>/index'

RSpec.describe <%= @resource_klass %>::Index do
  subject(:action) { described_class.new(request_params: params, listeners: listeners) }

  let(:params) { {} }
  let(:listeners) { [] }

  describe '#execute' do
    subject(:execute) { action.execute }

    let(:found_<%= @entity_name %>s) { [instance_double(<%= @entity_klass %>)] }

    before do
      allow(<%= @resource_klass %>::Repository).to receive(:all).and_return(found_<%= @entity_name %>s)
    end

    it 'returns a 200 response' do
      expect(execute).to have_attributes(status: 200)
    end
  end
end